<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">

<h:body  >

	<ui:composition template="/templates/template.xhtml">

		<ui:define name="content">
		
			<!-- Mensagem de Erro -->
			<p:growl id="growl" showDetail="true" autoUpdate="true" redisplay="false" life="5000" severity="info,warn,error"/>
 
			<h:form id="questionario2" styleClass="cad_form" rendered="#{usuario.usuario.perfil eq '3'}" onmouseover="#{acoes.carregarLista()}">

				<div class="ficha">

					<p:steps activeIndex="1" styleClass="custom tres" readonly="false">
						<p:menuitem value="Tipo de solicitação" url="/index.xhtml" />
						<p:menuitem value="Determinar Órgão / Entidade" url="/Solicitacao/questionario2.xhtml" />
						<p:menuitem value="Realizar Solicitação" url="#"/>
					</p:steps>

					<h:panelGroup styleClass="box" style="margin-bottom:1vw; max-width: 75vw">

						<h:outputText value="Determinar Órgão / Entidade" style="color:#1a568c; font-size:25px; margin: 0 5vw; align-self:center" />
						<p>Utilize a busca à esquerda para procurar um órgão ou entidade utilizando o assunto da sua manifestação, ou selecione o órgão/entidade diretamente no campo da direita.</p>

					<h:panelGroup styleClass="inline" style="width: 100%; justify-content: space-between; align-items: flex-start">
						<h:panelGroup styleClass="column" style="border: 1px solid #e3e3e3; padding: 15px; width: 45%">
							<p:outputLabel value="Buscar Órgão/Entidade:" style="font-weight: bold" />
						
							<p:outputLabel value="Assunto:" for="assunto" />
	        				<p:selectOneMenu id="assunto" value="#{competencias.idAcoes}" styleClass="field buscaField">
								 <p:ajax event="change" listener="#{competencias.filtrarCompetencias}" update = "cat entidades_panel" />
								 <f:selectItem itemLabel="Selecione" itemValue="0" noSelectionOption="true"/>
								 <f:selectItems value="#{acoes.acoes}" var="acoes" itemLabel="#{acoes.titulo}" itemValue= "#{acoes.idAcoes}"/>
							</p:selectOneMenu> 
	
							<p:outputLabel value="Categoria:" for="cat" />
							<p:selectOneMenu id="cat"  value="#{competencias.idEntidade}" style="max-width: 90%;" styleClass="field buscaField">
								 <p:ajax event="change" listener="#{competencias.filtraEntidades}" update = "entidades_panel" />
								 <f:selectItem itemLabel="Selecione" itemValue="0" noSelectionOption="true"/>
								 <f:selectItems value="#{competencias.listCompetencias}" var="comp" itemLabel="#{comp.descricao}" itemValue="#{comp.entidades.idEntidades}"/>
							</p:selectOneMenu>
						</h:panelGroup>
						
						<h:panelGroup styleClass="column" style="border: 1px solid #e3e3e3; padding: 15px; width: 45%">
							<p:outputLabel value="Selecionar Órgão/Entidade:" for="orgao"  style="font-weight: bold" />
	        				<p:selectOneMenu id="orgao" value="#{entidades.todasEntidades}" style="width:300px" styleClass="field selectField">
								<f:selectItem itemLabel="Selecione" itemValue="" noSelectionOption="true"/>
								<f:selectItems value="#{entidades.todasEntidades}" var="ent" itemLabel="#{ent.sigla} - #{ent.nome}" itemValue="#{solicitacao.solicitacao.entidades}"/>
							</p:selectOneMenu> 
						</h:panelGroup>
					</h:panelGroup>
					

						<p:outputLabel value="Selecione o Órgão/Entidade:" />

						<h:panelGroup id="entidades_panel">
							<p:dataTable id="entidades" widget="entidades" var="ent" emptyMessage="Selecione Assunto e Categoria" value="#{competencias.listEntidades}" selection="#{solicitacao.solicitacao.entidades}" rowKey="#{ent}" >
						        <p:ajax event="rowEdit" oncomplete="PF('entidades').filter()"/>
						        <p:column selectionMode="single" width="20"/>
						        <p:column headerText="Sigla" width="80">
						            <h:outputText value="#{ent.sigla}" />
						        </p:column>
						        <p:column headerText="Nome">
						            <h:outputText value="#{ent.nome}" />
						        </p:column>
						    </p:dataTable>

						</h:panelGroup>
					</h:panelGroup>

					<p:commandLink class="botaoLink" action="#{solicitacao.questionarioParaSolicitacao}">
						<h:outputText value="Continuar" />
						<f:setPropertyActionListener value="#{competencias.idAcoes}" target="#{solicitacao.idAcao}" />
						<i class="fa fa-arrow-right" style="margin-left: 5px" />
					</p:commandLink>

				</div>

			</h:form>
		
		<script>		
		function desativarCampos(abaField) {
		    var x = document.getElementsByClassName("field");
		    for (var i = 0; x.length > i ; i++) {
		    	x[i].disabled = true;
		    }
	
		    var y = document.getElementsByClassName(field);
		    for (var i = 0; y.length > i ; i++) {
		    	y[i].disabled = false;
		    }
		}
		</script>
			
		</ui:define>

	</ui:composition>

</h:body>

</html>