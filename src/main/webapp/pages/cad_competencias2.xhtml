<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">

<h:body>

	<ui:composition template="/templates/template.xhtml">

		<ui:define name="content">

			<h:form id="cad_competencias2" styleClass="cad_form" rendered="#{usuario.usuario.perfil eq '2' or usuario.usuario.perfil eq '5'}">

				<div class="ficha">

					<!--		Mensagens de Erro		-->
					<p:messages id="messages" showDetail="true" autoUpdate="true"
						closable="true" />

					<p:steps activeIndex="1" styleClass="custom" readonly="true">
						<p:menuitem value="Entidade" url="#" />
						<p:menuitem value="Competências" url="#" />
					</p:steps>

					<h:outputText
						value="Os campos abaixo marcados com * são de preenchimento obrigatório."
						style="color:gray; align-self: flex-start; padding-top: 2vw;" />

					<p:panelGrid style="margin-bottom:1vw; width: 50%">

						<f:facet name="header">
							<p:row>
								<p:column colspan="1">
									<h:outputText value="Cadastro de Competências"
										style="color:#1a568c; font-size:25px; padding-bottom: 2vw;" />
								</p:column>
							</p:row>
						</f:facet>

						<p:row>
							<p:column>
								<h:outputLabel value="Órgão/Entidade:"/>
									<br />
								<h:outputText id="redirect2"
									value="#{competencias.competencias.entidades.nome}" style="font-size:20px; padding-bottom: 2vw;"/>
							</p:column>
						</p:row>

						<p:row>
							<p:column>
								<h:outputLabel value="Ações: " for="acoes" />
							</p:column>
						</p:row>
						<p:row>
							<p:column>
								<p:selectOneMenu id="acoes" value="#{competencias.idAcoes}" >
									<f:selectItem itemLabel="Selecione" itemValue="0" />
									<f:selectItems value="#{competencias.acoes}" var="acs"
										itemLabel="#{acs.titulo}" itemValue="#{acs.idAcoes}" />
								</p:selectOneMenu>
							</p:column>
							<p:column>
								<h:outputLabel value="Ou" />
							</p:column>
								<p:column>
									<p:commandLink class="botaoLinkIcon" update="cad_competencias2"
										onclick="PF('dlg2').show();">
										<i class="fa fa-plus " />
										<h:outputLabel value=" Criar nova ação " />
									</p:commandLink>
								</p:column>
							
						</p:row>
						<p:row>
							<p:column>
								<h:outputLabel value="Descrição: " for="descricao" />
							</p:column>
						</p:row>
						<p:row>
							<p:column>
								<p:inputTextarea id="descricao" counter="display"
									value="#{competencias.competencias.descricao}" maxlength="200"
									autoResize="false" style="width:100%"
									counterTemplate="{0} caracteres restantes." />
								<h:outputText id="display" />
							</p:column>
						</p:row>

						<p:row>
							<p:column>
								<p:commandButton value="Adicionar"
									action="#{competencias.addLista}" update="cad_competencias2" />
							</p:column>
						</p:row>

					</p:panelGrid>
					
					<h:panelGroup id="entidades_panel" style="margin-bottom:1vw; width: 50%">
							<p:dataTable id="table" var="comp" emptyMessage="Nenhuma competência criada"
								value="#{competencias.listCompetencias}">
								<f:facet name="header">
								            Competências
								        </f:facet>
								<p:column headerText="Órgão/Entidade">
									<h:outputText value="#{comp.entidades.nome}" />
								</p:column>
								<p:column headerText="Ações">
										<h:outputLabel value="#{comp.acoes.titulo}" />
								</p:column>
								<p:column headerText="Descrição">
									<p:inplace editor="true">
										<p:inputTextarea value="#{comp.descricao}" />
									</p:inplace>
								</p:column>
								<p:column style="width:32px;text-align: center">
									<p:commandLink  class="botaoLinkIcon" update="cad_competencias2"
										action="#{competencias.listaCompetenciasUpdate}" title="View">
										<i class=" fa fa-trash" />
										<f:setPropertyActionListener value="#{comp}"
											target="#{competencias.competencias}" />
									</p:commandLink> 
								</p:column>
							</p:dataTable>
						</h:panelGroup>

					<p:commandLink class="botaoLink" action="#{competencias.save}">
						<h:outputText value="Salvar" />
						<i class="fa fa-check" style="color: white; padding-left: 3px" />
					</p:commandLink>

				</div>

			</h:form>

			<p:dialog header="Modal Dialog" widgetVar="dlg2" modal="true">
				<h:form>
					<p:outputPanel id="dlg" style="width:640px; height: 480px">
						<p:panelGrid columns="1">
							<h:outputText value="This is a Modal Dialog." />

							<p:outputLabel value="Título:" for="title" />
							<p:inputText id="title" value="#{acoes.acao.titulo}" />

							<p:outputLabel value="Descrição:" for="descr" />
							<p:inputTextarea id="descr" counter="display" maxlength="200"
								autoResize="false" style="width:100%"
								counterTemplate="{0} caracteres restantes."
								value="#{acoes.acao.descricao}" />
							<h:outputText id="display" />

						</p:panelGrid>

						<p:commandLink class="botaoLink" actionListener="#{acoes.save()}"
							style="margin:1vw 0" update="@all"
							oncomplete="PF('dlg2').hide();"
							rendered="#{usuario.usuario.perfil eq '2' or usuario.usuario.perfil eq '0'}">
							<h:outputText value="Salvar" />
							<i class="fa fa-hand-o-up" />
						</p:commandLink>

					</p:outputPanel>
				</h:form>

			</p:dialog>

		</ui:define>
	</ui:composition>

</h:body>
</html>

