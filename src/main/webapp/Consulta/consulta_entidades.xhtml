<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">

<h:body>

	<ui:composition template="/templates/template.xhtml">

		<ui:define name="content">
		
		<!-- Mensagem de Erro -->
		<p:growl id="growl" showDetail="true" autoUpdate="true" redisplay="false" life="5000" severity="info,warn,error"/>
			
			<h:form id="form" rendered="#{usuario.usuario.perfil eq '4' or usuario.usuario.perfil eq '2' }">

				<div class="ficha">
	
					<h:outputText value="Entidades"	style="color:#1a568c; font-size:25px; padding-bottom: 1vw;"	rendered="#{usuario.usuario.perfil eq '4' }" />
	
						<p:dataTable id="entidades" widget="orgaos" var="orgaos"
							emptyMessage="Nao há órgãos"
							filteredValue="#{entidades.todasEntidades}"
							sortBy="#{orgaos.sigla}" expandableRowGroups="false"
							value="#{entidades.todasEntidades}"
							rowStyleClass="#{orgaos.sigla}" paginator="true"
							paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
							rowsPerPageTemplate="5,10,15" rowKey="#{orgaos.idEntidades}"
							style="margin-bottom:1vw">
							
							<p:column headerText="Sigla" sortBy="#{orgaos.sigla}" width="70">
								<h:outputText value="#{orgaos.sigla}" />
							</p:column>
	
							<p:column headerText="Nome" sortBy="#{orgaos.nome}">
								<h:outputText value="#{orgaos.nome}" />
							</p:column>
	
							<p:column headerText="Status" sortBy="#{orgaos.ativa}" width="80">
								<h:outputText value="Ativo" rendered="#{orgaos.ativa}" />
								<h:outputText value="Inativo" rendered="#{not orgaos.ativa}" />
							</p:column>
	
							<p:column headerText="Ações" width="50" style="text-align: center" >
								<p:commandLink class="botaoLinkIcon"
									action="#{competencias.consultarCompetencias}" style="margin:5px">
									<i class="fa fa-plus" />
									<f:setPropertyActionListener value="#{orgaos}"
										target="#{competencias.ent}" />
								</p:commandLink>
							</p:column>
	
							<p:column headerText="Editar" width="45"  rendered="usuario.responsavel.nivel eq '3'"
								style="text-align: center">
								<p:commandLink class="botaoLinkIcon"  update="dialog:info" onclick="PF('editDialog').show();">
									<i class="fa fa-pencil-square-o" />
									<f:setPropertyActionListener value="#{orgaos}"
										target="#{entidades.entidades}" />
								</p:commandLink>
							</p:column>
	
							<p:column headerText="Solicitações" width="90" style="text-align: center">
								<p:commandLink class="botaoLinkIcon" action="#{solicitacao.consultarSolicitacaoGestor()}">
									<i class="fa fa-list" />
									<f:setPropertyActionListener value="#{orgaos.idEntidades}" target="#{solicitacao.idEntidades}" />
								</p:commandLink>
							</p:column>
						</p:dataTable>
	
						<h:commandLink action="/Cadastro/cad_entidades"
							style="display: flex; margin-top: 10px" styleClass="botaoLink">
							<i class="fa fa-plus" style="color: white; padding-right: 7px" />
							<h:outputText value="Nova Entidade" />
						</h:commandLink>
						
						</div>

				</h:form>

				<p:dialog widgetVar="editDialog" header="Editar Órgão / Entidade"
					modal="true" showHeader="true" fitViewport="true" showEffect="fade"
					hideEffect="fade" resizable="false" maximizable="false"
					draggable="false" closeOnEscape="true">
					<h:form id="dialog">
						<p:outputPanel id="entidadeEdit" style="display:flex; flex-flow: column">
							<p:panelGrid id="info" columns="2" layout="grid"
								style="border: none; width: 100%;">
								<p:outputLabel for="nome" value="Nome:" />
								<p:inputText id="nome" value="#{entidades.entidades.nome}" maxlength="200" >
									<f:validateLength maximum="200"/>
								</p:inputText>

								<p:outputLabel for="sigla" value="Sigla:" />
								<p:inputText id="sigla" value="#{entidades.entidades.sigla}" maxlength="10" >
									<f:validateLength maximum="10"/>
								</p:inputText>

								<p:outputLabel for="ativa" value="Status:" />
								<p:selectOneRadio id="ativa" value="#{entidades.entidades.ativa}">
									<f:selectItem itemLabel="Ativa" itemValue="true" />
									<f:selectItem itemLabel="Inativa" itemValue="false" />
								</p:selectOneRadio>

							</p:panelGrid>

							<p:commandLink class="botaoLink" action="#{entidades.edit}"
								oncomplete="PF('editDialog').hide();" update="form:entidades">
								<h:outputText value="Salvar" />
								<i class="fa fa-check" style="color: white; padding-left: 3px" />
							</p:commandLink>

						</p:outputPanel>
					</h:form>
				</p:dialog>

			

		</ui:define>
	</ui:composition>
</h:body>

</html>
